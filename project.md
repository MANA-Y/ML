## Система прогнозирования спроса для сети пиццерий

### 1. Цели и предпосылки 
#### 1.1. Зачем идем в разработку продукта?  

Бизнес-цели - оптимизация процессов производства на кухне за счет прогназирования спроса с использованием ML модели:
- Увеличение скорости производства;
- Оптимизация расписания работы персонала на кухне.

#### 1.2. Описание текущего бизнес-процесса

#### Принятие заказов
- Клиенты могут делать заказы через различные каналы: онлайн (веб-сайт, мобильное приложение), по телефону или лично в ресторане;
- Все поступившие заказы регистрируются в POS-системе (Point of Sale), которая учитывает время заказа, тип и количество пицц, а также специальные требования;
- Заказы автоматически распределяются по приоритету, учитывая время ожидания клиента.

#### Подготовка ингредиентов и продукции
- На основе поступивших заказов производится подготовка необходимых ингредиентов: нарезка продуктов, замес теста и т.д;
- Складской учет контролирует запасы ингредиентов, автоматически сигнализируя о необходимости пополнения запасов.

#### Производство
- Повара готовят пиццу в соответствии со стандартами качества и рецептурой, обращая внимание на правильность распределения ингредиентов и соблюдение технологического процесса;
- Готовые пиццы проходят контроль качества перед тем, как быть упакованными для доставки или подачи в зал.

#### Доставка и обслуживание в зале
- Для заказов с доставкой курьеры распределяются с учетом географического положения адресов и времени ожидания доставки;
- В зале официанты обеспечивают своевременную подачу блюд, контролируя качество сервиса.

#### Польза от внедрения ML модели
- Заблаговременная подготовка продуктов и доставка из склада;
- Оптимизация планирования зон кухни для массового приготовления продукции.

#### Критерии успеха
 - Успех итерации будет виден по повышению прибыли за счет сокращения издержек и времени производства.

### 2. Требования и ограничения  

#### Функциональные требования:
- Система прогнозирования спроса: оценка количества и типов пицц, необходимых в определенное время;
- Оптимизация расписания: автоматизация планирования задач для персонала кухни.

#### Нефункциональные требования:
- Масштабируемость: возможность легкого масштабирования системы при расширении сети ресторанов;
- Надежность: система должна обеспечивать высокую доступность и быстрое восстановление после сбоев;
- Безопасность: защита персональных данных клиентов и коммерческой информации.

#### Наличие данных:
- Исторические данные о заказах: время заказа, время приготовления, состав ингредиентов, спрос по временам года/дня;
- Параметры производственного процесса: время необходимое на различные этапы приготовления (замес теста, нарезка ингредиентов, выпечка), наличие и работа оборудования;
- Обратная связь от клиентов: уровень удовлетворенности качеством и временем ожидания.

### 3. Проектирование

#### Общая архитектура системы:
- Интеграция с существующей системой управления заказами для автоматического сбора данных о заказах;
- Сервер для обработки данных и хранения моделей машинного обучения;
- Клиентские приложения для отображения аналитики и управления производственным процессом в реальном времени.

#### Интерфейсы:
- REST API для обмена данными между компонентами системы и внешними системами;
- Веб-интерфейс для доступа руководства и персонала к средствам аналитики и управления.

#### Алгоритмы машинного обучения:
- Прогностическая модель спроса: использует исторические данные для прогнозирования количества заказов;
- Оптимизация производственных процессов: машинное обучение для распределения задач с учетом текущего спроса и ресурсов.

#### 1. Временные ряды для прогнозирования спроса
Архитектуры, основанные на временных рядах, подходят для прогнозирования спроса на продукцию. Например:
- ARIMA (Autoregressive Integrated Moving Average): классическая модель, хорошо подходит для прогнозирования спроса на основе исторических данных, если данные достаточно стабильны во времени.
- LSTM (Long Short-Term Memory) или GRU (Gated Recurrent Units) сети: типы рекуррентных нейронных сетей, подходящие для анализа временных рядов с долгосрочными зависимостями и сезонностью.

#### 2. Оптимизационные алгоритмы
Для оптимизации производственных процессов и расписания работы персонала могут быть использованы:
- Генетические алгоритмы: могут использоваться для нахождения оптимальных решений в условиях, когда прямое перебирание всех возможных вариантов невозможно из-за их огромного количества.
- Алгоритмы линейного программирования: подходят для задач, где необходимо оптимизировать некоторую целевую функцию при заданных ограничениях.

#### Инструменты и технологии:
- Python для разработки алгоритмов машинного обучения.
- PostgreSQL для хранения данных заказов и производственных параметров.
- PyTorch для создания и обучения моделей машинного обучения.
- Docker/Kubernetes для развертывания и масштабирования компонентов системы.

#### Диаграмма потока данных
- Прием заказа: Заказы поступают через веб-интерфейс или API от клиентов и передаются в систему управления заказами.
- Обработка заказа: Система анализирует текущие заказы, проверяет инвентарь и использует прогнозную модель спроса для определения нужного количества ингредиентов.
- Производство: На основе данных о спросе и текущих заказах система генерирует оптимизированный план производства и распределяет задачи среди сотрудников.
- Выполнение заказа: Готовые пиццы отмечаются в системе, после чего они могут быть переданы клиентам через доставку или самовывоз.

<img width="716" alt="Process" src="https://github.com/MANA-Y/ML/assets/87495835/e558a72b-0756-49e1-b7b5-9dcab85725c2">

#### **Данные**

|**Название данных**|**Наличие данных**|**Как получить данные**|**Качество данных**|
| :-: | :-: | :-: | :-: |
|Данные по продажам|SAP-система|Data manager/DS|Высокое|
|Геоданные|Да|SAP-система|Высокое|
|Чековые данные|ОФД|Product owner/DS|Не определено|
|Исторические прогнозы торговых|Excel файлы бизнеса|Product owner /DS|Не определено|

Общие требования к данным:
- Данные есть для полной базы точек, процент пропусков < 5%;
- Отсутствие дубликатов в ID магазинов, которые могут иметь разный код, но быть одним и тем же местом.

|**Название данных**|**Требования**|
| :-: | :-: |
|Данные по продажам|<p>- Требуется проверка на экстремальные значения продаж</p><p>- В продажах нет пропусков – учтены все каналы сбыта (напрямую по точке, через распределительный центр, через поставщиков)</p>|
|Геоданные|<p>- Координаты пиццерий не отличаются от настоящих более чем на 30 метров</p><p>- Имеется 20 трафиков для каждого магазина</p><p>- Трафики не должны быть схожи и/или дублированы</p><p>- Методология сбора трафиков не отличается от аналогичной для других пиццерий</p>|
|Чековые данные|<p>- Содержат помесячные продажи каждой категории отдельно</p><p>- Нет серьёзных отличий от продаж в системе (не более 50% в отдельной точке и месяце с поправкой на сезональность)</p>|
|Исторические прогнозы|- Имеются числовые прогнозы по месяцам|

**Риски:**
- Значение продаж в пиццерии не полное – например, не учтён один из каналов сбыта продукции. Потребуется поиск внутри системы продаж, объединение с имеющимися или иной метод восстановления данных;
- Чековые данные не похожи на имеющиеся в системе (иной формат, попала продукция конкурентов, слишком большое расхождение в значениях и т.д.) за аналогичный период продаж. Риск поставщика или специфика сбора данных в маленьких точках. В этом случае чековые данные использовать не стоит;
- Дубликаты ID магазинов трудно поддаются отчистке. Пример – разные ИП магазина, название и немного отличающаяся геолокация, хотя это один и тот же магазин. Требуется более точный алгоритм удаления дубликатов.

#### Интеграция с производственным процессом
- Система интегрируется с существующими POS-системами и системами управления заказами для автоматизированного сбора данных о заказах в реальном времени.
- Для передачи производственных задач сотрудникам используются интерфейсы пользовательских устройств (планшеты, мониторы на рабочих станциях).

<img width="992" alt="Screenshot 2024-02-16 at 16 45 09" src="https://github.com/MANA-Y/ML/assets/87495835/93c6f6f8-a4b1-40a2-8aff-a950a4d94f04">



